@using Blazored.LocalStorage

@page "/unauthorized"
@layout StatusCodeLayout

<MudContainer 
    MaxWidth="MaxWidth.Medium" 
    Class="d-flex justify-center align-center flex-column gap-8 pa-8 h-full">
    <MudText
        Typo="Typo.h2"
        Color="Color.Primary"
        Align="Align.Center"
        Class="title-2">
        Erro 403 - Acesso Negado
    </MudText>
        
    <MudText 
        Typo="Typo.body1"
        Align="Align.Center">
        Desculpe, você não tem permissão para acessar esta página.
    </MudText>
        
    <AuthorizeView Roles="Researcher">
        <MudButton 
            Href="/projects" 
            Variant="Variant.Filled" 
            Color="Color.Primary">
            Voltar para a página inicial
        </MudButton>
    </AuthorizeView>

    <AuthorizeView Roles="Reviewer">
        <MudButton
            Href="@Link"
            Variant="Variant.Filled"
            Color="Color.Primary">
            Voltar para a pesquisa
        </MudButton>
    </AuthorizeView>

    <AuthorizeView>
        <Authorized/>
        <NotAuthorized>
            <MudButton
                Href="/"
                Variant="Variant.Filled"
                Color="Color.Primary">
                Voltar para a página inicial
            </MudButton>
        </NotAuthorized>
    </AuthorizeView>
</MudContainer>

@code{

    [Inject] protected ILocalStorageService LocalStorage { get; set; } = null!;

    protected string ResearchCode { get; set; } = string.Empty;
    protected string Link { get; set; } = "/reviewers/login";

    protected override async Task OnInitializedAsync()
    {
        ResearchCode = await LocalStorage.GetItemAsync<string>("researchCode") ?? string.Empty;
        Link = $"reviewers/research/{ResearchCode}";
    }
}